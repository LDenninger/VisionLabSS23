{
    "model": "vae",
    "encoder_layers": [
        {
            "type": "conv2d",
            "in_channels": 3,
            "out_channels": 256,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ]
        },
        {
            "type": "batchnorm2d",
            "num_features": 256,
            "eps": 1e-05,
            "momentum": 0.1
        },
        {
            "type": "relu"
        },
        {
            "type": "maxpool2d",
            "kernel_size": [
                4,
                4
            ],
            "stride": [
                4,
                4
            ]
        },
        {
            "type": "conv2d",
            "in_channels": 256,
            "out_channels": 64,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ]
        },
        {
            "type": "batchnorm2d",
            "num_features": 64,
            "eps": 1e-05,
            "momentum": 0.1
        },
        {
            "type": "relu"
        },
        
        {
            "type": "maxpool2d",
            "kernel_size": [
                2,
                2
            ],
            "stride": [
                2,
                2
            ]
        },
        {
            "type": "conv2d",
            "in_channels": 64,
            "out_channels": 32,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ]
        },
        {
            "type": "batchnorm2d",
            "num_features": 32,
            "eps": 1e-05,
            "momentum": 0.1
        },
        {
            "type": "relu"
        },
        
        {
            "type": "maxpool2d",
            "kernel_size": [
                2,
                2
            ],
            "stride": [
                2,
                2
            ]
        },
        {
            "type": "flatten",
            "start_dim": 1,
            "end_dim": -1
        },
        {
            "type": "linear",
            "in_features": 6272,
            "out_features": 1000

        },
        {
            "type": "relu"
        }
     
    ],
    "decoder_layers": [
        {
            "type": "linear",
            "in_features": 1000,
            "out_features": 6272
        },
        {
            "type": "relu"
        },
        
        {
            "type": "reshape",
            "shape": [
                -1,
                32,
                14,
                14
            ]
        },
        {
            "type": "upsample",
            "scale": 2
        },
        {
            "type": "transConv2d",
            "in_channels": 32,
            "out_channels": 64,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ],
            "output_padding": 0
        },
        {
            "type": "batchnorm2d",
            "num_features": 64,
            "eps": 1e-05,
            "momentum": 0.1
        },
        {
            "type": "relu"
        },
        {
            "type": "upsample",
            "scale": 2
        },
        {
            "type": "transConv2d",
            "in_channels": 64,
            "out_channels": 256,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ],
            "output_padding": 0
        },
        {
            "type": "batchnorm2d",
            "num_features": 256,
            "eps": 1e-05,
            "momentum": 0.1
        },
        {
            "type": "relu"
        },
        {
            "type": "upsample",
            "scale": 4

        },
        {
            "type": "transConv2d",
            "in_channels": 256,
            "out_channels": 3,
            "kernel_size": [
                5,
                5
            ],
            "stride": [
                1,
                1
            ],
            "padding": [
                2,
                2
            ],
            "output_padding": 0
        },
        {
            "type": "sigmoid"
        }
    ],
    "latent_dim": [
        2048,
        2048
    ],
    "batch_size": 64,
    "num_epochs": 5,
    "num_iterations": 62,
    "num_eval_iterations": 200,
    "learning_rate": 3e-03,
    "random_seed": 22,
    "save_start": 2,
    "save_frequency": 1,    
    "pre_processing": 
        [
            {
                "type": "normalize",
                "train": true,
                "eval": true
            }
        ],
    "evaluation": {
        "metrics": [],
        "frequency": 1,
        "target_to_pred": false
    },
    "dataset": {
        "name": "food101",
        "train_size": 75750,
        "val_size": 25250,
        "test_size": 25250,
        "train_shuffle": true,
        "eval_shuffle": false,
        "drop_last": true,
        "classes": [
            0,
            1,
            2,
            3,
            4,
            5
        ]
    },
    "scheduler": {
        "epoch_scheduler": {
            "type": "exponential",
            "gamma": 0.85
        },
        "iteration_scheduler": null
    },
    "optimizer": {
        "type": "Adam"
    }
}